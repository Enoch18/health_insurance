import{C as k}from"./CustomModal.2fe4e5bb.js";import{C as x}from"./CustomSelectbox.85340afe.js";import{C as o}from"./CustomTextInput.f2c70347.js";import{T as w}from"./TopHeaderSection.db497e75.js";import{P as O}from"./Paper.f1fc2464.js";import{j as V,x as F,m as q,D as A}from"./MainLayout.0824f71e.js";import{r as m,a as d,j as t,c as g}from"./app.e0868774.js";import"./useTypedPage.b1bffe46.js";const B=({policy_holder:i})=>{i=i==null?void 0:i.data;const[c,f]=m.exports.useState([]),[N,h]=m.exports.useState(!1),[a,C]=m.exports.useState({}),[e,p]=m.exports.useState({}),u=m.exports.useRef(null);function l(r){const n=r.target.id,s=r.target.value;p(b=>({...b,[n]:s}))}const y=r=>{r.preventDefault();let n={};if(e!=null&&e.first_name||(n.first_name="First name is required"),e!=null&&e.last_name||(n.last_name="Last name is required"),e!=null&&e.date_of_birth||(n.date_of_birth="Date of birth is required"),e!=null&&e.gender||(n.gender="Gender is required"),e!=null&&e.relationship_to_policy_holder||(n.relationship_to_policy_holder="Relationship to policy holder is required"),Object.keys(n).length>0){C(n);return}f(s=>s.findIndex(_=>_.first_name===e.first_name&&_.last_name===e.last_name&&_.date_of_birth===e.date_of_birth)===-1?[...s,e]:s),h(!0)},D=()=>{g.post(`/policy-holders/${i.id}/dependants`,{dependants:c})};m.exports.useEffect(()=>{if((i==null?void 0:i.dependants)&&i.dependants.length>0){const r=i.dependants.map(n=>({dependant_id:n.id,first_name:n.first_name,last_name:n.last_name,gender:n.gender,date_of_birth:n.date_of_birth,relationship_to_policy_holder:n.relationship_to_policy_holder,contact_number:n.contact_number,email:n.email,address:n.address}));f(r),p(r[r.length-1])}},[]);const S=r=>{const n=c.filter(s=>s.first_name!==r.first_name&&s.last_name!==r.last_name&&s.date_of_birth!==r.date_of_birth);f(n)};return d(V,{title:"Create Dependants",children:[t(w,{title:"Add Dependants",hideAddBtn:!0}),d(O,{children:[d("h4",{className:"text-lg font-semibold",children:[d("span",{className:"text-orange-500",children:[i.attributes.first_name," ",i.attributes.last_name]})," ",">"," Dependants"]}),t("hr",{className:"border-gray-500"}),d("form",{ref:u,onSubmit:y,children:[d("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t(o,{id:"first_name",type:"text",name:"first_name",label:"First Name *",setValue:l,value:e==null?void 0:e.first_name,error:a==null?void 0:a.first_name}),t(o,{id:"last_name",type:"text",name:"last_name",label:"Last Name *",setValue:l,value:e==null?void 0:e.last_name,error:a==null?void 0:a.last_name}),t(o,{id:"date_of_birth",type:"date",name:"date_of_birth",label:"Date of birth *",setValue:l,value:e==null?void 0:e.date_of_birth,error:a==null?void 0:a.date_of_birth}),t(x,{id:"gender",name:"gender",label:"Gender *",data:[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"Other",value:"other"}],setValue:l,value:e==null?void 0:e.gender,error:a==null?void 0:a.gender}),t(x,{id:"relationship_to_policy_holder",name:"relationship_to_policy_holder",label:"Relationship to policy holder *",data:[{label:"Spouse",value:"spouse"},{label:"Child",value:"child"},{label:"Parent",value:"parent"},{label:"Sibling",value:"sibling"},{label:"Other",value:"other"}],setValue:l,value:e==null?void 0:e.relationship_to_policy_holder,error:a==null?void 0:a.relationship_to_policy_holder}),t(o,{id:"contact_number",type:"text",name:"contact_number",label:"Contact Number (Optional)",setValue:l,value:e==null?void 0:e.contact_number,error:a==null?void 0:a.contact_number}),t(o,{id:"email",type:"email",name:"email",label:"Email (Optional)",setValue:l,value:e==null?void 0:e.email,error:a==null?void 0:a.email}),t(o,{id:"address",type:"text",name:"address",label:"Address (Optional)",setValue:l,value:e==null?void 0:e.address,error:a==null?void 0:a.address})]}),c.length>0&&d("div",{className:"mt-3",children:[t("h4",{children:"Added Dependants"}),t("div",{className:"flex flex-row mt-2 gap-2",children:c.map((r,n)=>d("div",{className:"p-2 border rounded flex flex-row items-center justify-center gap-3",children:[d("div",{children:[d("h4",{children:[r.first_name," ",r.last_name]}),t("h4",{children:r.date_of_birth})]}),t("button",{onClick:()=>S(r),type:"button",children:t(F,{className:"text-2xl text-red-500"})}),t("button",{onClick:()=>p(r),type:"button",children:t(q,{className:"text-2xl text-green-500"})})]},n))})]}),d("div",{className:"flex flex-row justify-end gap-3 mt-3",children:[t("button",{onClick:()=>g.visit(`/policy-holders/${i.id}/medical-information/create`),type:"button",className:"px-2 py-1 min-w-40 rounded border",children:"Skip"}),t("button",{className:"bg-green-500 px-2 py-1 min-w-40 rounded",children:"Submit"})]})]})]}),t(k,{open:N,setOpen:()=>{},children:d("div",{className:"flex flex-col items-center justify-center",children:[t(A,{className:"text-5xl text-green-300"}),t("h4",{className:"text-center mt-3 text-lg",children:"Dependant Added successfully!"}),t("p",{className:"mt-3 italic",children:"Do you want to add another dependant?"}),d("div",{className:"flex flex-row gap-3 mt-3",children:[t("button",{onClick:()=>{h(!1),p({}),u.current.reset()},className:"bg-green-500 px-2 py-1 min-w-40 rounded",children:"Yes"}),t("button",{onClick:D,className:"bg-blue-500 px-2 py-1 min-w-40 rounded",children:"Proceed to next"})]})]})})]})};export{B as default};
