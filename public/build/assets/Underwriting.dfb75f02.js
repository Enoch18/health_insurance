import{C as $}from"./CustomModal.2fe4e5bb.js";import{C}from"./CustomSelectbox.85340afe.js";import{C as E}from"./CustomTextInput.f2c70347.js";import{r as m,q as V,a as c,j as t,F as U,c as p}from"./app.e0868774.js";import{T as D}from"./Table.361516fa.js";import{A as j}from"./Alert.bb949d5c.js";import{P as I}from"./PolicyHolderLayout.878fef71.js";import"./createSimplePaletteValueFilter.98a057b1.js";import"./MainLayout.0824f71e.js";import"./useTypedPage.b1bffe46.js";import"./Paper.f1fc2464.js";import"./KeyAndValue.364fd947.js";import"./TopHeaderSection.db497e75.js";const k=({excluded_name:e,policy_holder_id:g,dependant_id:x,exclusions:n,is_underwritten:N})=>{const w=[{label:"Exclusion name",id:"exclusion_name"},{label:"Exclusion Details",id:"exclusion_details"},{label:"",id:"actions",align:"right"}],[S,s]=m.exports.useState(!1),[r,b]=m.exports.useState({}),[f,u]=m.exports.useState(""),[v,h]=m.exports.useState(""),{errors:l}=V().props;function i(a){const o=a.target.id,T=a.target.value;b(A=>({...A,[o]:T}))}const d=a=>{a.preventDefault(),v?p.put(`/policy-holders/${g}/exclusions/${v}`,r,{onSuccess:()=>{s(!1)},onError:o=>{u(o.error),setTimeout(()=>{u("")},3e3)}}):p.post(`/policy-holders/${g}/exclusions`,r,{onSuccess:()=>{s(!1)},onError:o=>{u(o.error),setTimeout(()=>{u("")},3e3)}})};return c("div",{className:"mt-5",children:[c("div",{className:"flex flex-row justify-end mb-1",children:[t("div",{className:"flex flex-row flex-1",children:c("h4",{children:["Exclusions for ",t("span",{className:"text-blue-300",children:e})]})}),!N&&t("button",{onClick:()=>{s(!0),b(x?a=>({...a,dependant_id:x}):a=>({...a,policy_holder_id:g}))},className:"bg-green-500 px-2 rounded shadow",children:"Add Exclusion"})]}),t(D,{headers:w,rows:n==null?void 0:n.map(a=>({exclusion_name:a.exclusion_name,exclusion_details:a.exclusion_details,actions:t(U,{children:!N&&t("button",{onClick:()=>{s(!0),h(a.id),b({exclusion_name:a.exclusion_name,exclusion_details:a.exclusion_details})},className:"border text-white p-1 rounded shadow float-right",children:"Edit"})})})),hideCheckbox:!0,not_found:"No exclusions found!"}),t("form",{onSubmit:d,children:c($,{open:S,setOpen:s,children:[t("h4",{className:"text-lg mb-2",children:"Add Exclusion"}),t("hr",{}),f!==""&&f!==void 0&&t(j,{severity:"error",className:"mb-2",children:f}),t(E,{id:"exclusion_name",name:"exclusion_name",label:"Exclusion Name",setValue:i,value:r==null?void 0:r.exclusion_name,error:l==null?void 0:l.exclusion_name}),t(E,{id:"exclusion_details",name:"exclusion_details",label:"Exclusion Details",setValue:i,value:r==null?void 0:r.exclusion_details,error:l==null?void 0:l.exclusion_details}),t("button",{className:"bg-blue-500 p-2 text-white rounded shadow mt-2 w-full",children:"Submit"})]})})]})},Q=({policy_holder:e})=>{var f,u,v,h,l;const[g,x]=m.exports.useState(!1),[n,N]=m.exports.useState({policy_holder_id:(f=e==null?void 0:e.data)==null?void 0:f.id}),[w,S]=m.exports.useState(""),{errors:s}=V().props;function r(i){const d=i.target.id,a=i.target.value;N(o=>({...o,[d]:a}))}const b=i=>{i.preventDefault(),p.post(`/policy-holders/${e.data.id}/underwriting`,n,{onSuccess:()=>{x(!1)},onError:d=>{S(d.error),setTimeout(()=>{S("")},3e3)}})};return c(I,{policy_holder:e==null?void 0:e.data,children:[c("div",{className:"flex flex-row items-center",children:[t("div",{className:"flex flex-row flex-1",children:t("h2",{className:"text-lg font-bold",children:"Underwriting"})}),t("button",{onClick:()=>x(!0),className:`${(u=e==null?void 0:e.data)!=null&&u.underwriting?"bg-green-200 text-gray-500 font-semibold":"bg-blue-500 text-white"} py-2 px-5 rounded shadow`,disabled:!!((v=e==null?void 0:e.data)!=null&&v.underwriting),children:(h=e==null?void 0:e.data)!=null&&h.underwriting?"Underwritten!!!":"Underwrite"})]}),t("hr",{className:"border-gray-500 mt-1"}),t(k,{excluded_name:`${e.data.attributes.first_name} ${e.data.attributes.last_name}`,policy_holder_id:e.data.id,exclusions:e.data.exclusions,is_underwritten:!!((l=e==null?void 0:e.data)!=null&&l.underwriting)}),e.data.dependants.length>0&&e.data.dependants.map((i,d)=>{var a;return t(k,{excluded_name:`${i.first_name} ${i.last_name}`,dependant_id:i.id,exclusions:i.exclusions,is_underwritten:!!((a=e==null?void 0:e.data)!=null&&a.underwriting)},d)}),t("form",{onSubmit:b,children:c($,{open:g,setOpen:x,children:[t("h4",{className:"text-lg mb-2",children:"Underwrite Policy Holder"}),t("hr",{}),w!==""&&w!==void 0&&t(j,{severity:"error",className:"mb-2",children:w}),t(C,{id:"risk_level",name:"risk_level",label:"Risk Level",data:[{label:"Low",value:"low"},{label:"Moderate",value:"moderate"},{label:"High",value:"high"}],setValue:r,value:n==null?void 0:n.risk_level,error:s==null?void 0:s.risk_level}),t(E,{id:"notes",name:"notes",label:"Notes",setValue:r,value:n==null?void 0:n.notes,error:s==null?void 0:s.notes}),t(C,{id:"status",name:"status",label:"Status",data:[{label:"Pending",value:"pending"},{label:"Accepted",value:"accepted"},{label:"Rejected",value:"rejected"}],setValue:r,value:n==null?void 0:n.status,error:s==null?void 0:s.status}),t("button",{className:"bg-blue-500 p-2 text-white rounded shadow mt-2 w-full",children:"Submit"})]})})]})};export{Q as default};
